<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  <title>mcp4725 - NodeMCU Documentation</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>
  <link href='https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/highlight.css">
  <link href="../../../css/extra.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "mcp4725";
    var mkdocs_page_input_path = "en/modules/mcp4725.md";
    var mkdocs_page_url = "/en/modules/mcp4725/";
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js"></script>
  <script src="../../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> NodeMCU Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	  
          
		  
  <ul class="" href="../../..">
    <li class="toctree-l1">
  <a class="" href="../../..">Overview</a>
  </li></ul>
          
		  
  <p class="caption">English</p>
  <ul class="current">
          <li class="toctree-l1">
            
  <a class="" href="../../">Home</a>
        </li>
          <li class="toctree-l1">
            
  <a class="" href="../../build/">Building the firmware</a>
        </li>
          <li class="toctree-l1">
            
  <a class="" href="../../flash/">Flashing the firmware</a>
        </li>
          <li class="toctree-l1">
            
  <a class="" href="../../spiffs/">Internal filesystem notes</a>
        </li>
          <li class="toctree-l1">
            
  <a class="" href="../../sdcard/">Filesystem on SD card</a>
        </li>
          <li class="toctree-l1">
            
  <a class="" href="../../upload/">Uploading code</a>
        </li>
          <li class="toctree-l1">
            
  <a class="" href="/en/lua-developer-faq">FAQs</a>
        </li>
          <li class="toctree-l1">
            
  <a class="" href="../../support/">Support</a>
        </li>
          <li class="toctree-l1 current">
            
  <a class="current" href="/en/modules/adc">Modules</a>
  <ul class="subnav">
        <li class="toctree-l2 1">
            
  <a class="" href="../adc/">adc</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../ads1115/">ads1115</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../adxl345/">adxl345</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../am2320/">am2320</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../apa102/">apa102</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../bit/">bit</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../bme280/">bme280</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../bmp085/">bmp085</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../cjson/">cjson</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../coap/">coap</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../cron/">cron</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../crypto/">crypto</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../dht/">dht</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../ds18b20/">ds18b20</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../encoder/">encoder</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../enduser-setup/">enduser setup</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../file/">file</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../gdbstub/">gdbstub</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../gpio/">gpio</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../hdc1080/">hdc1080</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../hmc5883l/">hmc5883l</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../http/">http</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../hx711/">hx711</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../i2c/">i2c</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../l3g4200d/">l3g4200d</a>
        </li>
        <li class="toctree-l2 current 1">
            
  <a class="current" href="./">mcp4725</a>
  <ul class="subnav">
      
  <li class="toctree-l2 current">
  
    <a class="current"  href="#mcp4725-module">MCP4725 Module</a>
  
  
    <ul class="">
    
        <li class="toctree-l3 toc-item" >
          <a class="toctree-l3" href="#mcp4725read">mcp4725.read()</a>
        </li>
    
        <li class="toctree-l3 toc-item" >
          <a class="toctree-l3" href="#mcp4725write">mcp4725.write()</a>
        </li>
    
    </ul>
  
  </li>

  </ul>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../mdns/">mdns</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../mqtt/">mqtt</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../net/">net</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../node/">node</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../ow/">ow (1-Wire)</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../pcm/">pcm</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../perf/">perf</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../pwm/">pwm</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../rc/">rc</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../rfswitch/">rfswitch</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../rotary/">rotary</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../rtcfifo/">rtcfifo</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../rtcmem/">rtcmem</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../rtctime/">rtctime</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../si7021/">si7021</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../sigma-delta/">sigma delta</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../sjson/">sjson</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../sntp/">sntp</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../somfy/">somfy</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../spi/">spi</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../struct/">struct</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../switec/">switec</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../tcs34725/">tcs34725</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../tls/">tls</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../tm1829/">tm1829</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../tmr/">tmr</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../tsl2561/">tsl2561</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../u8g/">u8g</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../uart/">uart</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../ucg/">ucg</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../websocket/">websocket</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../wifi/">wifi</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../wps/">wps</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../ws2801/">ws2801</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../ws2812/">ws2812</a>
        </li>
        <li class="toctree-l2 1">
            
  <a class="" href="../xpt2046/">xpt2046</a>
        </li>
  </ul>
        </li>
  </ul>

          
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">NodeMCU Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>English &raquo;</li>
        
      
        
          <li>Modules &raquo;</li>
        
      
    
    <li>mcp4725</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/nodemcu/nodemcu-firmware/edit/master/docs/en/modules/mcp4725.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="mcp4725-module">MCP4725 Module<a class="headerlink" href="#mcp4725-module" title="Permanent link">&para;</a></h1>
<table>
<thead>
<tr>
<th align="left">Since</th>
<th align="left">Origin / Contributor</th>
<th align="left">Maintainer</th>
<th align="left">Source</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">2017-05-10</td>
<td align="left"><a href="https://github.com/dnc40085">dnc40085</a></td>
<td align="left"><a href="https://github.com/dnc40085">dnc40085</a></td>
<td align="left"><a href="../../../../app/modules/mcp4725.c">mcp4725.c</a></td>
</tr>
</tbody>
</table>
<p>This module provides access to the <a href="http://ww1.microchip.com/downloads/en/DeviceDoc/22039d.pdf">MCP4725 12-bit Digital to Analog Converter</a>.</p>
<p>!!!important:
    VDD is the power supply pin for the device. The voltage at the VDD pin is used as the supply input as well as the DAC reference input. The power supply at the VDD pin should be clean as possible for good DAC performance.</p>
<p>!!!note:
    The MCP4725 device address contains four fixed bits ( 1100 = device code) and three address bits (A2, A1, A0). The A2 and A1 bits are hard-wired during manufacturing, and A0 bit is determined by the logic state of A0 pin. The A0 pin can be connected to VDD or VSS , or actively driven by digital logic levels. The address pin(A0) can be actively driven by a GPIO to act as a chip select, allowing more than 2 devices to be used on the same bus.  </p>
<h2 id="mcp4725read">mcp4725.read()<a class="headerlink" href="#mcp4725read" title="Permanent link">&para;</a></h2>
<p>Gets contents of the dac register and EEPROM.</p>
<h4 id="syntax">Syntax<a class="headerlink" href="#syntax" title="Permanent link">&para;</a></h4>
<p><code>mcp4725.read({[a0], [a1], [a2]})</code></p>
<h4 id="parameters">Parameters<a class="headerlink" href="#parameters" title="Permanent link">&para;</a></h4>
<ul>
<li><code>A0</code> Address bit 0. This bit is user configurable via MCP4725 pin 6(A0). (valid states: 0 or 1) (default: 0)</li>
<li><code>A1</code> Address bit 1. This bit is hard-wired during manufacture. (valid states: 0 or 1) (default: 0)<ul>
<li>Note: Modules purchased from Adafruit have this bit(A1) set high(1).</li>
</ul>
</li>
<li><code>A2</code> Address bit 2. This bit is hard-wired during manufacture. (valid states: 0 or 1) (default: 0)</li>
</ul>
<h4 id="returns">Returns<a class="headerlink" href="#returns" title="Permanent link">&para;</a></h4>
<ul>
<li><code>cur_pwrdn</code> Current power down configuration value. </li>
<li><code>cur_val</code> Current value stored in dac register.</li>
<li><code>eeprom_pwrdn</code> Power down configuration stored in EEPROM.</li>
<li><code>eeprom_val</code> DAC value stored in EEPROM.</li>
<li><code>eeprom_state</code> EEPROM write status<ul>
<li><code>0</code> EEPROM write is incomplete.</li>
<li><code>1</code> EEPROM write has completed</li>
</ul>
</li>
<li><code>por_state</code> Power-On-Reset status;<ul>
<li><code>0</code> The MCP4725 is performing reset and is not ready.</li>
<li><code>1</code> The MCP4725 has sucessfully performed reset.</li>
</ul>
</li>
</ul>
<h4 id="example">Example<a class="headerlink" href="#example" title="Permanent link">&para;</a></h4>
<pre><code class="lua">-- Get current configuration using default i2c address 0x60(A0=0, A1=0, A2=0).
do
local ID = 0
local SDA = 6
local SCL = 5

i2c.setup(ID, SDA, SCL, i2c.SLOW)

local cur_pwrdn, cur_val, eeprom_pwrdn, eeprom_val, eeprom_state, por_state = mcp4725.read()

print(&quot;\n Current configuration:\n\tpower down value: &quot;..cur_pwrdn..&quot;\n\tdac value: &quot;..cur_val)
print(&quot; Configuration stored in EEPROM:\n\tpower down value: &quot;..eeprom_pwrdn..&quot;\n\tdac value: &quot;..eeprom_val)
print(&quot; EEPROM write state: &quot;..(eeprom_state==1 and &quot;Completed&quot; or &quot;incomplete&quot;))
print(&quot; Power-On-Reset state: &quot;..(por_state==1 and &quot;Completed&quot; or &quot;incomplete&quot;))
end

-- Get current configuration using default i2c address 0x60(A0=0, A1=0, A2=0).
-- The MCP4725's address pin(A0) is being driven with gpio 4(pin 2).
do
local ID = 0
local SDA = 6
local SCL = 5
local mcp4725_chip_sel = 2

i2c.setup(ID, SDA, SCL, i2c.SLOW)
gpio.mode(mcp4725_chip_sel, gpio.OUTPUT, gpio.PULLUP)

gpio.write(mcp4725_chip_sel, 1)
local cur_pwrdn, cur_val, eeprom_pwrdn, eeprom_val, eeprom_state, por_state = mcp4725.read({A0=1})
gpio.write(mcp4725_chip_sel, 0)

print(&quot;\n Current configuration:\n\tpower down value: &quot;..cur_pwrdn..&quot;\n\tdac value: &quot;..cur_val)
print(&quot; Configuration stored in EEPROM:\n\tpower down value: &quot;..eeprom_pwrdn..&quot;\n\tdac value: &quot;..eeprom_val)
print(&quot; EEPROM write state: &quot;..(eeprom_state==1 and &quot;Completed&quot; or &quot;incomplete&quot;))
print(&quot; Power-On-Reset state: &quot;..(por_state==1 and &quot;Completed&quot; or &quot;incomplete&quot;))
end
</code></pre>

<h4 id="see-also">See also<a class="headerlink" href="#see-also" title="Permanent link">&para;</a></h4>
<ul>
<li><a href="../i2c/#i2csetup"><code>i2c.setup()</code></a></li>
</ul>
<h2 id="mcp4725write">mcp4725.write()<a class="headerlink" href="#mcp4725write" title="Permanent link">&para;</a></h2>
<p>Write configuration to dac register or dac register and eeprom.</p>
<h4 id="syntax_1">Syntax<a class="headerlink" href="#syntax_1" title="Permanent link">&para;</a></h4>
<p><code>mcp4725.write({[a0], [a1], [a2], value, [pwrdn], [save]})</code></p>
<h4 id="parameters_1">Parameters<a class="headerlink" href="#parameters_1" title="Permanent link">&para;</a></h4>
<ul>
<li><code>A0</code> Address bit 0. This bit is user configurable via MCP4725 pin 6(A0). (valid states: 0 or 1) (default: 0)</li>
<li><code>A1</code> Address bit 1. This bit is hard-wired during manufacture. (valid states: 0 or 1) (default: 0)<ul>
<li>Note: Modules purchased from Adafruit have this bit(A1) set high(1).</li>
</ul>
</li>
<li><code>A2</code> Address bit 2. This bit is hard-wired during manufacture. (valid states: 0 or 1) (default: 0)</li>
<li><code>value</code> The value to be used to configure DAC (and EEPROM). (Range: 0 - 4095)</li>
<li><code>pwrdn</code> Set power down bits.<ul>
<li><code>mcp4725.PWRDN_NONE</code> MCP4725 output enabled. (Default)</li>
<li><code>mcp4725.PWRDN_1K</code> MCP4725 output disabled, output pulled to ground via 1K restistor.</li>
<li><code>mcp4725.PWRDN_100K</code> MCP4725 output disabled, output pulled to ground via 100K restistor.</li>
<li><code>mcp4725.PWRDN_500K</code> MCP4725 output disabled, output pulled to ground via 500K restistor.</li>
</ul>
</li>
<li><code>save</code> Save pwrdn and dac values to EEPROM. (Values are loaded on power-up or during reset.)<ul>
<li><code>true</code> Save configuration to EEPROM.</li>
<li><code>false</code> Do not save configuration to EEPROM. (Default) </li>
</ul>
</li>
</ul>
<h4 id="returns_1">Returns<a class="headerlink" href="#returns_1" title="Permanent link">&para;</a></h4>
<p>nil</p>
<h4 id="example_1">Example<a class="headerlink" href="#example_1" title="Permanent link">&para;</a></h4>
<pre><code class="lua">
-- Set current configuration using default i2c address 0x60(A0=0, A1=0, A2=0).
do
  local ID = 0
  local SDA = 6
  local SCL = 5

  i2c.setup(ID, SDA, SCL, i2c.SLOW)
  mcp4725.write({value=2048})
end

-- Set current configuration and save to EEPROM using default i2c address 0x60(A0=0, A1=0, A2=0).
do
  local ID = 0
  local SDA = 6
  local SCL = 5

  i2c.setup(ID, SDA, SCL, i2c.SLOW)
  mcp4725.write({value=2048, save=true})
end

-- Set current configuration using default i2c address 0x60(A0=0, A1=0, A2=0).
-- The MCP4725's address pin(A0) is being driven with gpio 4(pin 2).
do
  local ID = 0
  local SDA = 6
  local SCL = 5
  local mcp4725_chip_sel = 2

  i2c.setup(ID, SDA, SCL, i2c.SLOW)
  gpio.mode(mcp4725_chip_sel, gpio.OUTPUT, gpio.PULLUP)

  gpio.write(mcp4725_chip_sel, 1)
  mcp4725.read({A0=1, value})
  gpio.write(mcp4725_chip_sel, 0)
end
</code></pre>

<h4 id="see-also_1">See also<a class="headerlink" href="#see-also_1" title="Permanent link">&para;</a></h4>
<ul>
<li><a href="../i2c/#i2csetup"><code>i2c.setup()</code></a></li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../mdns/" class="btn btn-neutral float-right" title="mdns">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../l3g4200d/" class="btn btn-neutral" title="l3g4200d"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/nodemcu/nodemcu-firmware/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../l3g4200d/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../mdns/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../js/extra.js"></script>
      <script src="../../../search/require.js"></script>
      <script src="../../../search/search.js"></script>

</body>
</html>
